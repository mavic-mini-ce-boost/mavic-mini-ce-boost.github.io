<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DJI Mavic Mini CE max power boost</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

</head>
<body>
  <div class="container">
    <h1>DJI Mavic Mini CE boost</h1>

    <h2>Disclaimer</h2>
    <p>This is an experiment solely for educational purpose.</p>
    <p>Please do not attempt it as this will void your warranty and can possibly violate local regulations on radio usage. Here you will also find instructions on how to roll back applied changes.</p>

    <h2>Overview</h2>
    <!--<p>Mavic Mini comes in several hardware versions for different markets. FCC for USA, CE for Europe and there's a version for Japan. FCC, CE and Japanese version all differ in hardware of the aircraft (AC) and the remote controller (RC).</p>-->
    <ol>
      <li>Step 1. Make the drone "think" it is in USA or Bolivia.</li>
      <li>Step 2. Prevent the Remote Controller from changing that setting in the drone.</li>
    </ol>

    <h2>Browser support</h2>
    <ul>
      <li>Chrome 80+</li>
      <li>Opera (you need to enable it's flag in opera://flags/#enable-experimental-web-platform-features)</li>
      <li>Edge (Chromium based)</li>
    </ul>
    <p>No FireFox yet.</p>

    <h2>Enable your browser</h2>
    <p>At this moment you need to enable your browser's Experimental Web Platform Features, just copy and paste the right URL:</p>
    <pre>
    chrome://flags/#enable-experimental-web-platform-features
    opera://flags/#enable-experimental-web-platform-features
    edge://flags/#enable-experimental-web-platform-features
    </pre>

    <h2>Remote Controller</h2>
    <ol>
      <li>Connect your Remote Controller with USB cable to this computer.</li>
      <li>Turn the Remote ON.</li>
      <li>Click the button to select the Serial port of the Remote and apply patch:
        <button class="btn btn-success" id="btn-patch">
          Apply Patch
        </button>
      </li>
    </ol>



  </div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

<script>
  const patch = async () => {
    if ('serial' in navigator) {
      try {
        const port = await navigator.serial.requestPort();
        console.log(port);
        const info = port.getInfo();
        if (info.usbProductId && info.usbVendorId) {
          if (info.usbProductId == 8  &&  usbVendorId == 11427) {
            // Mavic Mini remote, for sure
          }
        }

        await port.open({ baudRate: 9600, baudrate: 9600 }); // spelling varies
        this.reader = port.readable.getReader();
        this.writer = port.writable.getWriter();

        const data = {
          boost: new Uint8Array([0x55,0x0e,0x04,0x66,0x2a,0x1b,0x07,0x27,0x40,0x06,0xfb,0x02,0xac,0x35]),
          stock: new Uint8Array([0x55,0x0e,0x04,0x66,0x2a,0x1b,0x25,0xf9,0x40,0x06,0xfb,0x03,0x9c,0x37]),
        };

        this.writer.write(data.boost);

        console.log("All done");
      }
      catch (err) {
        console.error('There was an error opening the serial port:', err);
      }
    } else {
      console.error('The Web serial API doesn\'t seem to be enabled in your browser.');
    }
  }

  const btn = document.querySelector('#btn-patch');
  btn.addEventListener('click', patch);

</script>
</body>
</html>